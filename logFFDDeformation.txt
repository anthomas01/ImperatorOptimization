Traceback (most recent call last):
  File "runFFDDeformation.py", line 182, in <module>
    DVGeo.addGeoDVLocal("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
TypeError: addGeoDVLocal() got an unexpected keyword argument 'secIndex'
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26121,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addLocalSectionDV("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
AttributeError: 'DVGeometry' object has no attribute 'addLocalSectionDV'
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26112,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addLocalSectionDV("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
AttributeError: 'DVGeometry' object has no attribute 'addLocalSectionDV'
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26221,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addLocalSectionDV("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
AttributeError: 'DVGeometry' object has no attribute 'addLocalSectionDV'
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26212,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addGeoDVSectionLocal("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
  File "/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/pygeo/DVGeometry.py", line 1120, in addGeoDVSectionLocal
    pts, ind = pointSelect.getPoints(self.FFD.coef)
  File "/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/pygeo/geo_utils.py", line 1455, in getPoints
    ptList.append(points[self.indices[i]])
IndexError: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26203,1],0]
  Exit code:    1
--------------------------------------------------------------------------
  File "runFFDDeformation.py", line 182
    bPS = geo_utils.PointSelect("list", indexList[;])
                                                  ^
SyntaxError: invalid syntax
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26194,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addGeoDVSectionLocal("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
  File "/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/pygeo/DVGeometry.py", line 1120, in addGeoDVSectionLocal
    pts, ind = pointSelect.getPoints(self.FFD.coef)
  File "/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/pygeo/geo_utils.py", line 1455, in getPoints
    ptList.append(points[self.indices[i]])
IndexError: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26190,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addLocalSectionDV("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
AttributeError: 'DVGeometry' object has no attribute 'addLocalSectionDV'
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26181,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Traceback (most recent call last):
  File "runFFDDeformation.py", line 183, in <module>
    DVGeo.addGeoDVSectionLocal("boattail_shape_r", secIndex='i', lower=-1.0, upper=1.0, scale=1.0, axis=1, pointSelect=bPS, orient0=None, orient2="ffd")
  File "/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/pygeo/DVGeometry.py", line 1120, in addGeoDVSectionLocal
    pts, ind = pointSelect.getPoints(self.FFD.coef)
  File "/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/pygeo/geo_utils.py", line 1455, in getPoints
    ptList.append(points[self.indices[i]])
IndexError: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices
-------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code.. Per user-direction, the job has been aborted.
-------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[26300,1],0]
  Exit code:    1
--------------------------------------------------------------------------
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.84449808182185 -9.933957093001235 -9.912017801315855) (21.81552508266855 9.936885484498704 9.912045175098534)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.175599086876175e-16 6.060169494580008e-16 -3.939080675190614e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.963868567314381e+96, number of cells 7095
  <<Writing 7095 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 5.969522994130321e-09. Maximum face area = 0.9940623419104079.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.011663980375066e-06, Number of negative volume cells: 7095
  <<Writing 7095 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9319933757025 average: 16.56442530090428
   *Number of severely non-orthogonal (> 70 degrees) faces: 17578.
 ***Number of non-orthogonality errors: 23321.
  <<Writing 40899 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 46567 faces are incorrectly oriented.
  <<Writing 27512 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 5843.503456108285, 2314 highly skew faces detected which may impair the quality of the results
  <<Writing 2314 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.93313004640435 -9.97911727052845 -9.956134288095594) (21.9261866974987 9.990934447063488 9.956465841082649)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (9.03841475259032e-17 -3.86974372369773e-16 3.022654594447121e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.037444043941663e+96, number of cells 7444
  <<Writing 7444 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.543724237901711e-10. Maximum face area = 0.9975437263083907.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -3.890639990621937e-06, Number of negative volume cells: 7442
  <<Writing 7442 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9453392379823 average: 16.93889955557031
   *Number of severely non-orthogonal (> 70 degrees) faces: 14691.
 ***Number of non-orthogonality errors: 24238.
  <<Writing 38929 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 48220 faces are incorrectly oriented.
  <<Writing 27023 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 26157.12331053888, 1534 highly skew faces detected which may impair the quality of the results
  <<Writing 1534 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88871786290573 -9.95804692968777 -9.996522952311347) (21.88824244177792 9.936915251576426 9.97407575455226)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.132940521301356e-16 -2.792751184602777e-17 -7.113073014479639e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.606728657992132e+96, number of cells 7032
  <<Writing 7032 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.824975718791422e-09. Maximum face area = 0.9961291058852482.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.26801371639585e-06, Number of negative volume cells: 7030
  <<Writing 7030 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9198510225832 average: 16.37198721530056
   *Number of severely non-orthogonal (> 70 degrees) faces: 16094.
 ***Number of non-orthogonality errors: 23214.
  <<Writing 39308 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 45921 faces are incorrectly oriented.
  <<Writing 26755 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 13322.30547281842, 2077 highly skew faces detected which may impair the quality of the results
  <<Writing 2077 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.93313004640435 -9.97911727052845 -9.956134288095594) (21.9261866974987 9.990934447063488 9.956465841082649)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (9.03841475259032e-17 -3.86974372369773e-16 3.022654594447121e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.037444043941663e+96, number of cells 7444
  <<Writing 7444 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.543724237901711e-10. Maximum face area = 0.9975437263083907.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -3.890639990621937e-06, Number of negative volume cells: 7442
  <<Writing 7442 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9453392379823 average: 16.93889955557031
   *Number of severely non-orthogonal (> 70 degrees) faces: 14691.
 ***Number of non-orthogonality errors: 24238.
  <<Writing 38929 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 48220 faces are incorrectly oriented.
  <<Writing 27023 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 26157.12331053888, 1534 highly skew faces detected which may impair the quality of the results
  <<Writing 1534 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88406506223375 -9.964959367237357 -9.997120284548821) (21.88189478478751 9.976952338452287 10.0118505016208)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (9.800321246094065e-17 2.767906611806136e-17 -5.734711616997982e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.903247810025955e+96, number of cells 6150
  <<Writing 6150 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.557930838668691e-09. Maximum face area = 0.9975217769845646.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.537213996776536e-06, Number of negative volume cells: 6150
  <<Writing 6150 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9549864751914 average: 16.12745796690717
   *Number of severely non-orthogonal (> 70 degrees) faces: 18239.
 ***Number of non-orthogonality errors: 20361.
  <<Writing 38600 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 40317 faces are incorrectly oriented.
  <<Writing 23834 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 16542.11905479405, 2109 highly skew faces detected which may impair the quality of the results
  <<Writing 2109 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.93962748341616 -9.973329581486995 -10.0008155498338) (21.9409319385543 9.981628134892407 10.00843980069729)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-9.418230994873167e-18 -2.148360535127922e-16 2.803832360969575e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.006836103319823e+96, number of cells 4534
  <<Writing 4534 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.541372982103296e-08. Maximum face area = 0.9988501767189971.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.878196228432332e-06, Number of negative volume cells: 4532
  <<Writing 4532 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.818022243943 average: 15.35782530501171
   *Number of severely non-orthogonal (> 70 degrees) faces: 16216.
 ***Number of non-orthogonality errors: 14941.
  <<Writing 31157 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 29601 faces are incorrectly oriented.
  <<Writing 17287 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 6268.934777792612, 1347 highly skew faces detected which may impair the quality of the results
  <<Writing 1347 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.92278677358787 -9.960975075559306 -9.974733641552634) (21.92023312422335 9.974583527122695 9.98960038314911)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.35434881997812e-17 2.53317599275599e-16 1.537911988942382e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.508948174298965e+96, number of cells 7852
  <<Writing 7852 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.543988080741602e-10. Maximum face area = 0.9973626445268536.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.258620882828962e-06, Number of negative volume cells: 7850
  <<Writing 7850 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.8524800202883 average: 16.82716223218115
   *Number of severely non-orthogonal (> 70 degrees) faces: 13442.
 ***Number of non-orthogonality errors: 25483.
  <<Writing 38925 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 50700 faces are incorrectly oriented.
  <<Writing 28316 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 2068.946271431625, 1604 highly skew faces detected which may impair the quality of the results
  <<Writing 1604 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87829169367953 -9.979059108585185 -9.928577718978907) (21.86559995712427 9.963153884793257 9.927849789704162)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (6.963018531214457e-17 1.973595098430573e-16 2.754407901142143e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.647241436511988e+96, number of cells 6777
  <<Writing 6777 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 6.749604838542967e-09. Maximum face area = 0.9956111403790883.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -7.500887753899751e-06, Number of negative volume cells: 6774
  <<Writing 6774 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9122277486501 average: 16.18788501976643
   *Number of severely non-orthogonal (> 70 degrees) faces: 16795.
 ***Number of non-orthogonality errors: 22312.
  <<Writing 39107 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 44081 faces are incorrectly oriented.
  <<Writing 25371 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 4871.083604368243, 1878 highly skew faces detected which may impair the quality of the results
  <<Writing 1878 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.94326015974016 -9.998147370892479 -9.993387803459298) (21.94536679682049 9.993919378065369 10.00215237538595)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-5.672175362020322e-17 1.985726245793796e-16 1.95998073510457e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.620313591603051e+96, number of cells 2872
  <<Writing 2872 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.970962582613078e-09. Maximum face area = 0.9995464121853309.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.963146234371999e-06, Number of negative volume cells: 2871
  <<Writing 2871 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.720159250428 average: 14.98325676828834
   *Number of severely non-orthogonal (> 70 degrees) faces: 16364.
 ***Number of non-orthogonality errors: 9730.
  <<Writing 26094 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 19042 faces are incorrectly oriented.
  <<Writing 11140 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 1653.181133941957, 838 highly skew faces detected which may impair the quality of the results
  <<Writing 838 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90294176801214 -9.973930518626391 -9.94979000271238) (21.89275627254137 9.966561343804297 9.94954393960008)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (3.876048929524315e-17 1.009275473065284e-16 -7.019571187956453e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465823997926725e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544529959247965e-10. Maximum face area = 0.997868768036645.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.77432897002467e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9124706319777 average: 15.68967630659641
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19218.
  <<Writing 31616 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37970 faces are incorrectly oriented.
  <<Writing 21448 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 29448.06324895964, 1348 highly skew faces detected which may impair the quality of the results
  <<Writing 1348 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87030395096011 -9.971276164935226 -9.956506529769422) (21.84583528680346 9.970263604939646 9.955638107456632)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-7.582178086933805e-17 -2.165976447141444e-18 -3.162002901627132e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.712539739025324e+96, number of cells 4345
  <<Writing 4345 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.242814015558495e-10. Maximum face area = 0.9970974913648704.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.996454771176657e-06, Number of negative volume cells: 4343
  <<Writing 4343 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.759083462315 average: 15.48255232717477
   *Number of severely non-orthogonal (> 70 degrees) faces: 19849.
 ***Number of non-orthogonality errors: 14218.
  <<Writing 34067 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28363 faces are incorrectly oriented.
  <<Writing 16945 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 4613.744380789237, 1530 highly skew faces detected which may impair the quality of the results
  <<Writing 1530 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87030395096011 -9.971276164935226 -9.956506529769422) (21.84583528680346 9.970263604939646 9.955638107456632)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-7.582178086933805e-17 -2.165976447141444e-18 -3.162002901627132e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.712539739025324e+96, number of cells 4345
  <<Writing 4345 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.242814015558495e-10. Maximum face area = 0.9970974913648704.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.996454771176657e-06, Number of negative volume cells: 4343
  <<Writing 4343 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.759083462315 average: 15.48255232717477
   *Number of severely non-orthogonal (> 70 degrees) faces: 19849.
 ***Number of non-orthogonality errors: 14218.
  <<Writing 34067 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28363 faces are incorrectly oriented.
  <<Writing 16945 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 4613.744380789237, 1530 highly skew faces detected which may impair the quality of the results
  <<Writing 1530 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.86299985045978 -9.961842077255017 -9.943680847961849) (21.83756570034767 9.961089472926458 9.943037581374117)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-4.909748996297648e-17 8.175623819901489e-17 2.440330503708489e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.067510562617394e+96, number of cells 5740
  <<Writing 5740 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 5.527851601276608e-09. Maximum face area = 0.9964511129509864.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.61296852420688e-06, Number of negative volume cells: 5740
  <<Writing 5740 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.8992735253358 average: 15.64529308563664
   *Number of severely non-orthogonal (> 70 degrees) faces: 15525.
 ***Number of non-orthogonality errors: 19011.
  <<Writing 34536 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37313 faces are incorrectly oriented.
  <<Writing 21812 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 5617.755111796956, 1811 highly skew faces detected which may impair the quality of the results
  <<Writing 1811 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90294200342555 -9.97393037876903 -9.949789818277907) (21.89275658352273 9.966561406487386 9.949543853519351)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (2.673305194440444e-17 2.206690387578895e-16 3.965763483668101e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465823077946596e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544770651728681e-10. Maximum face area = 0.9978687679555958.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.774328224859317e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9124810411061 average: 15.68967912856921
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19218.
  <<Writing 31616 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37970 faces are incorrectly oriented.
  <<Writing 21448 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 143766.2290748471, 1348 highly skew faces detected which may impair the quality of the results
  <<Writing 1348 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88387618103115 -9.981522563740711 -9.966601174473674) (21.86217325959041 9.981151011938412 9.966097544954692)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.274253842509597e-16 -2.805715758072289e-17 2.281406443575916e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.043750660204121e+96, number of cells 5284
  <<Writing 5284 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 9.319331103255621e-09. Maximum face area = 0.9986135047858534.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.812468701606765e-06, Number of negative volume cells: 5284
  <<Writing 5284 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9236981551905 average: 15.42247110542158
   *Number of severely non-orthogonal (> 70 degrees) faces: 16102.
 ***Number of non-orthogonality errors: 17413.
  <<Writing 33515 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34599 faces are incorrectly oriented.
  <<Writing 19596 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 10553.61268270362, 1267 highly skew faces detected which may impair the quality of the results
  <<Writing 1267 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87669815501961 -9.913208110256344 -9.894498148000245) (21.85334541108496 9.912536310787187 9.893748382346979)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (9.623495427852258e-17 8.143649106715353e-17 -4.046962023999929e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.381025499801502e+96, number of cells 8064
  <<Writing 8064 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.703960698385495e-09. Maximum face area = 0.9928255971680097.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -7.570841350150679e-06, Number of negative volume cells: 8064
  <<Writing 8064 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9681596842777 average: 16.93801048742455
   *Number of severely non-orthogonal (> 70 degrees) faces: 18884.
 ***Number of non-orthogonality errors: 26428.
  <<Writing 45312 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 52224 faces are incorrectly oriented.
  <<Writing 30296 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 53113.82612104412, 2395 highly skew faces detected which may impair the quality of the results
  <<Writing 2395 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88348040158304 -9.9810739823356 -9.966197593093229) (21.86173099285713 9.980702298690529 9.965684892085086)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.197262998053165e-16 -6.56656180376729e-17 3.200206555217654e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.665091702117657e+96, number of cells 5644
  <<Writing 5644 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.269584212952956e-08. Maximum face area = 0.9985521071334997.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.468575830370715e-06, Number of negative volume cells: 5643
  <<Writing 5643 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9688990206922 average: 15.58565785881074
   *Number of severely non-orthogonal (> 70 degrees) faces: 16940.
 ***Number of non-orthogonality errors: 18660.
  <<Writing 35600 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37090 faces are incorrectly oriented.
  <<Writing 21029 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 7674.738071269297, 1399 highly skew faces detected which may impair the quality of the results
  <<Writing 1399 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88348040158304 -9.9810739823356 -9.966197593093229) (21.86173099285713 9.980702298690529 9.965684892085086)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.197262998053165e-16 -6.56656180376729e-17 3.200206555217654e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.665091702117657e+96, number of cells 5644
  <<Writing 5644 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.269584212952956e-08. Maximum face area = 0.9985521071334997.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.468575830370715e-06, Number of negative volume cells: 5643
  <<Writing 5643 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9688990206922 average: 15.58565785881074
   *Number of severely non-orthogonal (> 70 degrees) faces: 16940.
 ***Number of non-orthogonality errors: 18660.
  <<Writing 35600 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37090 faces are incorrectly oriented.
  <<Writing 21029 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 7674.738071269297, 1399 highly skew faces detected which may impair the quality of the results
  <<Writing 1399 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88348014705677 -9.981074021092729 -9.96619760125783) (21.86173074458457 9.98070233742472 9.965684951240968)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.449765755633663e-16 1.021315088589504e-16 9.789195381545011e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.666370736620072e+96, number of cells 5643
  <<Writing 5643 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.269225508574133e-08. Maximum face area = 0.9985521055121291.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.468386889554698e-06, Number of negative volume cells: 5642
  <<Writing 5642 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.968867912504 average: 15.58615837043231
   *Number of severely non-orthogonal (> 70 degrees) faces: 16943.
 ***Number of non-orthogonality errors: 18662.
  <<Writing 35605 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37092 faces are incorrectly oriented.
  <<Writing 21029 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 9026.328836781984, 1405 highly skew faces detected which may impair the quality of the results
  <<Writing 1405 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.9029394939114 -9.973934666701997 -9.949790060456971) (21.89275443862152 9.966561180988158 9.949544292526513)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.140807014787381e-16 -6.406223102647513e-17 -8.376878886118798e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465744783387998e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544499401174577e-10. Maximum face area = 0.9978689382106383.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.774202423416713e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9128410877987 average: 15.68945077091067
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19217.
  <<Writing 31615 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37966 faces are incorrectly oriented.
  <<Writing 21446 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 3720.056085691699, 1344 highly skew faces detected which may impair the quality of the results
  <<Writing 1344 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.9029394939114 -9.973934666701997 -9.949790060456971) (21.89275443862152 9.966561180988158 9.949544292526513)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.140807014787381e-16 -6.406223102647513e-17 -8.376878886118798e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465744783387998e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544499401174577e-10. Maximum face area = 0.9978689382106383.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.774202423416713e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9128410877987 average: 15.68945077091067
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19217.
  <<Writing 31615 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37966 faces are incorrectly oriented.
  <<Writing 21446 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 3720.056085691699, 1344 highly skew faces detected which may impair the quality of the results
  <<Writing 1344 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.86770901226657 -9.980635247897176 -9.9628178908072) (21.84307671103273 9.979678484677171 9.961169666200691)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-5.912561512017341e-17 1.386263731818108e-16 -1.081134744513678e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.414405204926401e+96, number of cells 6223
  <<Writing 6223 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.212881946762166e-10. Maximum face area = 0.9967072474473728.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.921294078388937e-06, Number of negative volume cells: 6222
  <<Writing 6222 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.6885932995421 average: 16.16608692927442
   *Number of severely non-orthogonal (> 70 degrees) faces: 18953.
 ***Number of non-orthogonality errors: 20628.
  <<Writing 39581 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 41007 faces are incorrectly oriented.
  <<Writing 23609 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 17373.44341511187, 1769 highly skew faces detected which may impair the quality of the results
  <<Writing 1769 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.86770901226657 -9.980635247897023 -9.962817890806512) (21.84307671103206 9.97967848467729 9.961169666201259)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-6.46588549727227e-17 -1.37673619474357e-16 1.676534029558069e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.414405204926044e+96, number of cells 6223
  <<Writing 6223 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.212881950034381e-10. Maximum face area = 0.9967072474473623.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.921294078391256e-06, Number of negative volume cells: 6222
  <<Writing 6222 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.6885932999342 average: 16.16608692927506
   *Number of severely non-orthogonal (> 70 degrees) faces: 18953.
 ***Number of non-orthogonality errors: 20628.
  <<Writing 39581 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 41007 faces are incorrectly oriented.
  <<Writing 23609 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 17373.44451738815, 1769 highly skew faces detected which may impair the quality of the results
  <<Writing 1769 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.86770901226657 -9.980635247897023 -9.962817890806512) (21.84307671103206 9.97967848467729 9.961169666201259)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-6.46588549727227e-17 -1.37673619474357e-16 1.676534029558069e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.414405204926044e+96, number of cells 6223
  <<Writing 6223 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.212881950034381e-10. Maximum face area = 0.9967072474473623.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.921294078391256e-06, Number of negative volume cells: 6222
  <<Writing 6222 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.6885932999342 average: 16.16608692927506
   *Number of severely non-orthogonal (> 70 degrees) faces: 18953.
 ***Number of non-orthogonality errors: 20628.
  <<Writing 39581 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 41007 faces are incorrectly oriented.
  <<Writing 23609 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 17373.44451738815, 1769 highly skew faces detected which may impair the quality of the results
  <<Writing 1769 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87028988811754 -9.97280489243324 -9.954731435225405) (21.84579429947846 9.971931150019161 9.953758334768519)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-5.090743030414515e-17 -6.311941720606495e-17 1.285324818684518e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.710665747156326e+96, number of cells 4329
  <<Writing 4329 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.755805664237438e-10. Maximum face area = 0.9972501010932964.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -7.026067600184596e-06, Number of negative volume cells: 4327
  <<Writing 4327 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.6289223003577 average: 15.47584376816567
   *Number of severely non-orthogonal (> 70 degrees) faces: 19798.
 ***Number of non-orthogonality errors: 14199.
  <<Writing 33997 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28303 faces are incorrectly oriented.
  <<Writing 16911 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 82502.84362437071, 1548 highly skew faces detected which may impair the quality of the results
  <<Writing 1548 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88388314303787 -9.98152702645222 -9.966607817632644) (21.86218964269728 9.981156669974064 9.9660925245598)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.74150755365898e-18 3.126141721058808e-16 2.083730894603181e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.043165943013028e+96, number of cells 5280
  <<Writing 5280 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 9.809891550583238e-09. Maximum face area = 0.9986140754161961.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.812269889152522e-06, Number of negative volume cells: 5280
  <<Writing 5280 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9240221315001 average: 15.41986641140565
   *Number of severely non-orthogonal (> 70 degrees) faces: 16110.
 ***Number of non-orthogonality errors: 17390.
  <<Writing 33500 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34561 faces are incorrectly oriented.
  <<Writing 19575 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 7984.476209176513, 1282 highly skew faces detected which may impair the quality of the results
  <<Writing 1282 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88388314303787 -9.98152702645222 -9.966607817632644) (21.86218964269728 9.981156669974064 9.9660925245598)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.74150755365898e-18 3.126141721058808e-16 2.083730894603181e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.043165943013028e+96, number of cells 5280
  <<Writing 5280 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 9.809891550583238e-09. Maximum face area = 0.9986140754161961.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.812269889152522e-06, Number of negative volume cells: 5280
  <<Writing 5280 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9240221315001 average: 15.41986641140565
   *Number of severely non-orthogonal (> 70 degrees) faces: 16110.
 ***Number of non-orthogonality errors: 17390.
  <<Writing 33500 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34561 faces are incorrectly oriented.
  <<Writing 19575 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 7984.476209176513, 1282 highly skew faces detected which may impair the quality of the results
  <<Writing 1282 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.86303376020382 -9.962398966462931 -9.943058318730662) (21.83751377640727 9.961646195805205 9.942571305660426)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (2.755379395512852e-17 -4.636791290636847e-16 -1.214150146795725e-18) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.067757533181363e+96, number of cells 5744
  <<Writing 5744 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.550268108007663e-08. Maximum face area = 0.9964922814623464.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.621498465361409e-06, Number of negative volume cells: 5744
  <<Writing 5744 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9880555926381 average: 15.64277653516116
   *Number of severely non-orthogonal (> 70 degrees) faces: 15486.
 ***Number of non-orthogonality errors: 19000.
  <<Writing 34486 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37253 faces are incorrectly oriented.
  <<Writing 21781 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 37183.98828923278, 1828 highly skew faces detected which may impair the quality of the results
  <<Writing 1828 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88388230026877 -9.981526964505695 -9.966611442227791) (21.86218987773158 9.98115688692544 9.966088664864401)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-3.973535438534016e-17 1.152766974324454e-16 2.514043668093217e-18) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.041589739602124e+96, number of cells 5279
  <<Writing 5279 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.294313399408563e-08. Maximum face area = 0.9986140537082393.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.810542339237703e-06, Number of negative volume cells: 5278
  <<Writing 5278 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9625509397174 average: 15.42044864774249
   *Number of severely non-orthogonal (> 70 degrees) faces: 16110.
 ***Number of non-orthogonality errors: 17397.
  <<Writing 33507 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34564 faces are incorrectly oriented.
  <<Writing 19579 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 20387.66935112129, 1278 highly skew faces detected which may impair the quality of the results
  <<Writing 1278 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.8703022898012 -9.972891635852351 -9.954514962875074) (21.84588663540228 9.971663962590741 9.953957076463693)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.067550669777186e-16 1.909010137765771e-17 1.571365898983449e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.633284008916634e+96, number of cells 4319
  <<Writing 4319 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.884223853301381e-10. Maximum face area = 0.9971763739837974.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -7.026502394196372e-06, Number of negative volume cells: 4317
  <<Writing 4317 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9540079810029 average: 15.47562769944427
   *Number of severely non-orthogonal (> 70 degrees) faces: 19700.
 ***Number of non-orthogonality errors: 14184.
  <<Writing 33884 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28280 faces are incorrectly oriented.
  <<Writing 16928 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 43675.07946441787, 1564 highly skew faces detected which may impair the quality of the results
  <<Writing 1564 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.8703022898012 -9.972891635852351 -9.954514962875074) (21.84588663540228 9.971663962590741 9.953957076463693)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.067550669777186e-16 1.909010137765771e-17 1.571365898983449e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.633284008916634e+96, number of cells 4319
  <<Writing 4319 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 3.884223853301381e-10. Maximum face area = 0.9971763739837974.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -7.026502394196372e-06, Number of negative volume cells: 4317
  <<Writing 4317 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9540079810029 average: 15.47562769944427
   *Number of severely non-orthogonal (> 70 degrees) faces: 19700.
 ***Number of non-orthogonality errors: 14184.
  <<Writing 33884 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28280 faces are incorrectly oriented.
  <<Writing 16928 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 43675.07946441787, 1564 highly skew faces detected which may impair the quality of the results
  <<Writing 1564 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90249792415543 -9.973678108320982 -9.950118629729861) (21.8920113924153 9.966652231909373 9.949511649137596)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (1.281622338885391e-16 2.549550210714128e-17 -5.970847296850916e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.46665405288771e+96, number of cells 5822
  <<Writing 5822 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.138674346280713e-10. Maximum face area = 0.9978608579933251.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.775573123710514e-06, Number of negative volume cells: 5821
  <<Writing 5821 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.994996535027 average: 15.68735059674595
   *Number of severely non-orthogonal (> 70 degrees) faces: 12384.
 ***Number of non-orthogonality errors: 19204.
  <<Writing 31588 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37938 faces are incorrectly oriented.
  <<Writing 21437 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 3930.586179448921, 1349 highly skew faces detected which may impair the quality of the results
  <<Writing 1349 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90249792415561 -9.973678108321391 -9.950118629729966) (21.89201139241569 9.966652231909212 9.9495116491375)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (3.893861113462371e-17 -9.065356229962451e-17 -1.014358899556597e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.466654052887402e+96, number of cells 5822
  <<Writing 5822 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.13867434716437e-10. Maximum face area = 0.997860857993335.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.775573123709524e-06, Number of negative volume cells: 5821
  <<Writing 5821 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9949965350998 average: 15.68735059674713
   *Number of severely non-orthogonal (> 70 degrees) faces: 12384.
 ***Number of non-orthogonality errors: 19204.
  <<Writing 31588 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37938 faces are incorrectly oriented.
  <<Writing 21437 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 3930.586182821624, 1349 highly skew faces detected which may impair the quality of the results
  <<Writing 1349 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90249792415561 -9.973678108321391 -9.950118629729966) (21.89201139241569 9.966652231909212 9.9495116491375)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (3.893861113462371e-17 -9.065356229962451e-17 -1.014358899556597e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.466654052887402e+96, number of cells 5822
  <<Writing 5822 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.13867434716437e-10. Maximum face area = 0.997860857993335.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.775573123709524e-06, Number of negative volume cells: 5821
  <<Writing 5821 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9949965350998 average: 15.68735059674713
   *Number of severely non-orthogonal (> 70 degrees) faces: 12384.
 ***Number of non-orthogonality errors: 19204.
  <<Writing 31588 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37938 faces are incorrectly oriented.
  <<Writing 21437 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 3930.586182821624, 1349 highly skew faces detected which may impair the quality of the results
  <<Writing 1349 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87030648740414 -9.973580340339655 -9.954116460176559) (21.84583286718905 9.972410111292637 9.953649148699915)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-3.232170683916124e-17 -7.870044954664711e-17 -6.293278268343212e-18) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.631906796203264e+96, number of cells 4316
  <<Writing 4316 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.406103901664111e-10. Maximum face area = 0.9971868750744173.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -7.019943154815693e-06, Number of negative volume cells: 4316
  <<Writing 4316 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.8115695349389 average: 15.47696908642044
   *Number of severely non-orthogonal (> 70 degrees) faces: 19690.
 ***Number of non-orthogonality errors: 14194.
  <<Writing 33884 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28311 faces are incorrectly oriented.
  <<Writing 16944 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 5276.817152045143, 1570 highly skew faces detected which may impair the quality of the results
  <<Writing 1570 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90294190180055 -9.973930335550733 -9.949790029082891) (21.89275627408582 9.966561421396724 9.94954373487945)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.650896608992549e-16 3.455156123270555e-16 2.033056276762957e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465824966250631e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544514577964755e-10. Maximum face area = 0.9978687702698126.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.774332062772675e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9126106161703 average: 15.68967856546998
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19218.
  <<Writing 31616 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37970 faces are incorrectly oriented.
  <<Writing 21448 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 25782.84697849697, 1348 highly skew faces detected which may impair the quality of the results
  <<Writing 1348 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90294190180055 -9.973930335550733 -9.949790029082891) (21.89275627408582 9.966561421396724 9.94954373487945)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.650896608992549e-16 3.455156123270555e-16 2.033056276762957e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465824966250631e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544514577964755e-10. Maximum face area = 0.9978687702698126.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.774332062772675e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9126106161703 average: 15.68967856546998
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19218.
  <<Writing 31616 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37970 faces are incorrectly oriented.
  <<Writing 21448 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 25782.84697849697, 1348 highly skew faces detected which may impair the quality of the results
  <<Writing 1348 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.90294176801214 -9.973930518626391 -9.94979000271238) (21.89275627254137 9.966561343804297 9.94954393960008)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (3.876048929524315e-17 1.009275473065284e-16 -7.019571187956453e-17) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.465823997926725e+96, number of cells 5823
  <<Writing 5823 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 1.544529959247965e-10. Maximum face area = 0.997868768036645.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.77432897002467e-06, Number of negative volume cells: 5823
  <<Writing 5823 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9124706319777 average: 15.68967630659641
   *Number of severely non-orthogonal (> 70 degrees) faces: 12398.
 ***Number of non-orthogonality errors: 19218.
  <<Writing 31616 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37970 faces are incorrectly oriented.
  <<Writing 21448 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 29448.06324895964, 1348 highly skew faces detected which may impair the quality of the results
  <<Writing 1348 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87030395096011 -9.971276164935226 -9.956506529769422) (21.84583528680346 9.970263604939646 9.955638107456632)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-7.582178086933805e-17 -2.165976447141444e-18 -3.162002901627132e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.712539739025324e+96, number of cells 4345
  <<Writing 4345 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.242814015558495e-10. Maximum face area = 0.9970974913648704.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.996454771176657e-06, Number of negative volume cells: 4343
  <<Writing 4343 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.759083462315 average: 15.48255232717477
   *Number of severely non-orthogonal (> 70 degrees) faces: 19849.
 ***Number of non-orthogonality errors: 14218.
  <<Writing 34067 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28363 faces are incorrectly oriented.
  <<Writing 16945 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 4613.744380789237, 1530 highly skew faces detected which may impair the quality of the results
  <<Writing 1530 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.87030395096011 -9.971276164935226 -9.956506529769422) (21.84583528680346 9.970263604939646 9.955638107456632)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-7.582178086933805e-17 -2.165976447141444e-18 -3.162002901627132e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.712539739025324e+96, number of cells 4345
  <<Writing 4345 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 2.242814015558495e-10. Maximum face area = 0.9970974913648704.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.996454771176657e-06, Number of negative volume cells: 4343
  <<Writing 4343 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.759083462315 average: 15.48255232717477
   *Number of severely non-orthogonal (> 70 degrees) faces: 19849.
 ***Number of non-orthogonality errors: 14218.
  <<Writing 34067 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 28363 faces are incorrectly oriented.
  <<Writing 16945 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 4613.744380789237, 1530 highly skew faces detected which may impair the quality of the results
  <<Writing 1530 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.86299985045978 -9.961842077255364 -9.943680847961854) (21.8375657003481 9.961089472926139 9.943037581374112)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-2.605769733744586e-17 -6.762762177928164e-17 2.251914646423739e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 5.067510562616726e+96, number of cells 5740
  <<Writing 5740 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 5.527851600029903e-09. Maximum face area = 0.996451112950983.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -6.612968524203378e-06, Number of negative volume cells: 5740
  <<Writing 5740 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.8992735253467 average: 15.64529308564015
   *Number of severely non-orthogonal (> 70 degrees) faces: 15525.
 ***Number of non-orthogonality errors: 19011.
  <<Writing 34536 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 37313 faces are incorrectly oriented.
  <<Writing 21812 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 5617.754868244557, 1811 highly skew faces detected which may impair the quality of the results
  <<Writing 1811 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88387618103115 -9.981522563740835 -9.96660117447375) (21.86217325959066 9.981151011938298 9.966097544954623)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.503345300459062e-16 -4.048146333640712e-17 1.121078312479348e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.043750660204514e+96, number of cells 5284
  <<Writing 5284 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 9.319331101258738e-09. Maximum face area = 0.9986135047858593.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.812468701604864e-06, Number of negative volume cells: 5284
  <<Writing 5284 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9236981551619 average: 15.4224711054212
   *Number of severely non-orthogonal (> 70 degrees) faces: 16102.
 ***Number of non-orthogonality errors: 17413.
  <<Writing 33515 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34599 faces are incorrectly oriented.
  <<Writing 19596 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 10553.61277189787, 1267 highly skew faces detected which may impair the quality of the results
  <<Writing 1267 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88387618103115 -9.981522563740711 -9.966601174473674) (21.86217325959041 9.981151011938412 9.966097544954692)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.274253842509597e-16 -2.805715758072289e-17 2.281406443575916e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.043750660204121e+96, number of cells 5284
  <<Writing 5284 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 9.319331103255621e-09. Maximum face area = 0.9986135047858534.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.812468701606765e-06, Number of negative volume cells: 5284
  <<Writing 5284 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9236981551905 average: 15.42247110542158
   *Number of severely non-orthogonal (> 70 degrees) faces: 16102.
 ***Number of non-orthogonality errors: 17413.
  <<Writing 33515 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34599 faces are incorrectly oriented.
  <<Writing 19596 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 10553.61268270362, 1267 highly skew faces detected which may impair the quality of the results
  <<Writing 1267 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
 
-------------------------------------------------------------------------------
|                               DAFoam v2.2.9                                 |
-------------------------------------------------------------------------------
 
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Create time

Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Create mesh for time = 0
Initializing mesh and runtime for DASolver
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
Initializing fields for DARhoSimpleCFoam
Create simpleControl.

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

Reading thermophysical properties

Selecting thermodynamics package 
{
    mixture         pureMixture;
    specie          specie;
    equationOfState perfectGas;
    energy          sensibleInternalEnergy;
    thermo          hConst;
    type            hePsiThermo;
    transport       const;
}

Reading field U

Reading/calculating face flux field phi

Creating turbulence model

Selecting turbulence model type RAS
Selecting RAS turbulence model SpalartAllmarasFv3
Selecting patchDistMethod meshWave
Adjoint States: 
5
(
U volVectorState
nuTilda modelState
phi surfaceScalarState
p volScalarState
T volScalarState
)
Global Cells: 750389
Global Faces: 2357361
Global Xv: 2577033
Undecomposed points: 859011
Global Adjoint States: 6859695

SIMPLE: no convergence criteria found. Calculations will run for 3000 steps.

DACheckMesh Thresholds: 
maxNonOrth: 70
maxSkewness: 4
maxAspectRatio: 1000
maxIncorrectlyOrientedFaces: 0
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
    Adding all faces of patches 5(nosecone bodyTube finCan boattailStraight nozzle) ...
    Found matching patch boattailStraight with 2611 faces.
    Found matching patch bodyTube with 23564 faces.
    Found matching patch finCan with 31665 faces.
    Found matching patch nosecone with 4974 faces.
    Found matching patch nozzle with 952 faces.
DAFoam option dictionary: 
{
    solverName      DARhoSimpleCFoam;
    primalMinResTol 1e-06;
    primalBC
    {
        U0
        {
            variable        U;
            patches         6 ( front back bot top left right );
            value           3 ( 300 0 0 );
        }
        p0
        {
            variable        p;
            patches         6 ( front back bot top left right );
            value           1 ( 101325 );
        }
        T0
        {
            variable        T;
            patches         6 ( front back bot top left right );
            value           1 ( 300 );
        }
        nuTilda0
        {
            variable        nuTilda;
            patches         6 ( front back bot top left right );
            value           1 ( 4.47e-05 );
        }
        useWallFunction 1;
    }
    normalizeStates
    {
        p               101325;
        phi             1;
        U               300;
        T               300;
        nuTilda         0.000447;
        k               1;
        epsilon         1;
        omega           1;
        p_rgh           1;
        D               1;
    }
    objFunc
    {
        CD
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 1 0 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
        CL
        {
            part1
            {
                type            force;
                source          patchToFace;
                patches         5 ( nosecone bodyTube finCan boattailStraight nozzle );
                directionMode   fixedDirection;
                direction       3 ( 0 1 0 );
                scale           0.0008335365599658601;
                addToAdjoint    1;
            }
        }
    }
    designVar
    {
        boattail_shape_r1
        {
            designVarType   FFD;
        }
        boattail_shape_r2
        {
            designVarType   FFD;
        }
        boattail_shape_r3
        {
            designVarType   FFD;
        }
        boattail_shape_r4
        {
            designVarType   FFD;
        }
    }
    designSurfaces  1 ( boattailStraight );
    fvSource
    {
    }
    primalVarBounds
    {
        UMax            1000;
        UMin            -1000;
        pMax            500000;
        pMin            20000;
        p_rghMax        1e+16;
        p_rghMin        -1e+16;
        eMax            500000;
        eMin            100000;
        TMax            1e+16;
        TMin            -1e+16;
        hMax            1e+16;
        hMin            -1e+16;
        DMax            1e+16;
        DMin            -1e+16;
        rhoMax          5;
        rhoMin          0.2;
        nuTildaMax      1e+16;
        nuTildaMin      1e-16;
        kMax            1e+16;
        kMin            1e-16;
        omegaMax        1e+16;
        omegaMin        1e-16;
        epsilonMax      1e+16;
        epsilonMin      1e-16;
        ReThetatMax     1e+16;
        ReThetatMin     1e-16;
        gammaIntMax     1e+16;
        gammaIntMin     1e-16;
    }
    multiPoint      0;
    nMultiPoints    1;
    adjPartDerivFDStep
    {
        State           1e-06;
        FFD             0.001;
        BC              0.01;
        AOA             0.001;
        ACTP            0.01;
        ACTD            0.01;
        ACTL            0.01;
    }
    transonicPCOption 1;
    unsteadyAdjoint
    {
        mode            None;
        nTimeInstances  -1;
        periodicity     -1;
    }
    objFuncAvgStart 1;
    adjPCLag        1;
    useAD
    {
        mode            reverse;
        dvName          None;
        seedIndex       -9999;
    }
    rootDir         ./;
    runStatus       None;
    printPYDAFOAMOptions 0;
    printDAOptions  1;
    debug           0;
    writeJacobians  1 ( None );
    printInterval   100;
    printIntervalUnsteady 500;
    primalMinResTolDiff 100;
    adjUseColoring  1;
    adjEqnOption
    {
        globalPCIters   0;
        asmOverlap      1;
        localPCIters    1;
        jacMatReOrdering rcm;
        pcFillLevel     1;
        gmresMaxIters   1500;
        gmresRestart    1500;
        gmresRelTol     1e-06;
        gmresAbsTol     1e-14;
        gmresTolDiff    100;
        useNonZeroInitGuess 0;
        printInfo       1;
    }
    normalizeResiduals 10 ( URes pRes p_rghRes nuTildaRes phiRes TRes DRes kRes omegaRes epsilonRes );
    maxResConLv4JacPCMat
    {
        pRes            2;
        phiRes          1;
        URes            2;
        TRes            2;
        nuTildaRes      2;
        kRes            2;
        epsilonRes      2;
        omegaRes        2;
        p_rghRes        2;
        DRes            2;
    }
    jacLowerBounds
    {
        dRdW            1e-30;
        dRdWPC          1e-30;
    }
    maxTractionBCIters 100;
    decomposeParDict
    {
        method          scotch;
        simpleCoeffs
        {
            n               3 ( 2 2 1 );
            delta           0.001;
        }
        preservePatches 1 ( None );
    }
    adjStateOrdering state;
    meshSurfaceFamily None;
    designSurfaceFamily designSurfaces;
    checkMeshThreshold
    {
        maxAspectRatio  1000;
        maxNonOrth      70;
        maxSkewness     4;
        maxIncorrectlyOrientedFaces 0;
    }
    writeSensMap    1 ( NONE );
    writeDeformedFFDs 1;
}

Reading OpenFOAM mesh information...
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
I/O    : uncollated
pyDAFoam initialization done!
+---------------------------------------+
|     All IDWarp Options:               |
+---------------------------------------+
{'LdefFact': 1.0,
 'aExp': 3.0,
 'alpha': 0.25,
 'bExp': 5.0,
 'bucketSize': 8,
 'cornerAngle': 30.0,
 'errTol': 0.0005,
 'evalMode': 'fast',
 'fileType': 'openfoam',
 'gridFile': '/home/dafoamuser/mount',
 'restartFile': None,
 'specifiedSurfaces': None,
 'symmTol': 1e-06,
 'symmetryPlanes': [],
 'symmetrySurfaces': None,
 'useRotations': True,
 'zeroCornerRotations': True}
I/O    : uncollated
Case   : /home/dafoamuser/mount
nProcs : 1
Reading the OpenFOAM mesh..
Overriding DebugSwitches according to controlDict
    SolverPerformance 0;

Checking if we need to compress the mesh files
Checking if we need to compress the mesh files
#------------------------------#
 Total Volume Nodes :    859011 
#------------------------------#
I/O    : uncollated
OrderedDict([('back', [0]), ('boattailStraight', [1]), ('bodyTube', [2]), ('bot', [3]), ('finCan', [4]), ('front', [5]), ('left', [6]), ('nosecone', [7]), ('nozzle', [8]), ('right', [9]), ('top', [10]), ('allSurfaces', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]), ('allWalls', [1, 2, 4, 7, 8]), ('designSurfaces', [1])])
+-------------------- Symmetry Planes -------------------+
|           Point                        Normal          |
+--------------------------------------------------------+
#--------------------------------#
 Unique Surface Nodes :     66124 
#--------------------------------#
 Computing Denomenator Estimate...
 Load Balancing...
 Finished Mesh Initialization.
DVGeo PointSet UpToDate: False
Updating DVGeo PointSet....
DVGeo PointSet UpToDate: True
Warping the volume mesh....
Running Primal Solver 000
Previous solution time -1e+10 not found and nothing deleted.
Setting up primal boundary conditions based on pyOptions: 
Setting primal boundary conditions...
Setting U = (300 0 0) at front
Setting primal boundary conditions...
Setting U = (300 0 0) at back
Setting primal boundary conditions...
Setting U = (300 0 0) at bot
Setting primal boundary conditions...
Setting U = (300 0 0) at top
Setting primal boundary conditions...
Setting U = (300 0 0) at left
Setting primal boundary conditions...
Setting U = (300 0 0) at right
Setting primal boundary conditions...
Setting p = 101325 at front
Setting primal boundary conditions...
Setting p = 101325 at back
Setting primal boundary conditions...
Setting p = 101325 at bot
Setting primal boundary conditions...
Setting p = 101325 at top
Setting primal boundary conditions...
Setting p = 101325 at left
Setting primal boundary conditions...
Setting p = 101325 at right
Setting primal boundary conditions...
Setting T = 300 at front
Setting primal boundary conditions...
Setting T = 300 at back
Setting primal boundary conditions...
Setting T = 300 at bot
Setting primal boundary conditions...
Setting T = 300 at top
Setting primal boundary conditions...
Setting T = 300 at left
Setting primal boundary conditions...
Setting T = 300 at right
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at front
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at back
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at bot
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at top
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at left
Setting primal boundary conditions...
Setting nuTilda = 4.47e-05 at right
Setting nut wall BC for boattailStraight. BCType=nutUSpaldingWallFunction
Setting nut wall BC for bodyTube. BCType=nutUSpaldingWallFunction
Setting nut wall BC for finCan. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nosecone. BCType=nutUSpaldingWallFunction
Setting nut wall BC for nozzle. BCType=nutUSpaldingWallFunction

Starting time loop

Checking mesh quality for time = 0
    Overall domain bounding box (-17.88387618103115 -9.981522563740711 -9.966601174473674) (21.86217325959041 9.981151011938412 9.966097544954692)
    Mesh has 3 geometric (non-empty/wedge) directions 3{1}
    Mesh has 3 solution (non-empty) directions 3{1}
    Boundary openness (-1.274253842509597e-16 -2.805715758072289e-17 2.281406443575916e-16) OK.
 ***High aspect ratio cells found, Max aspect ratio: 6.043750660204121e+96, number of cells 5284
  <<Writing 5284 cells with high aspect ratio to set highAspectRatioCells
    Minimum face area = 9.319331103255621e-09. Maximum face area = 0.9986135047858534.  Face area magnitudes OK.
 ***Zero or negative cell volume detected.  Minimum negative volume: -5.812468701606765e-06, Number of negative volume cells: 5284
  <<Writing 5284 zero volume cells to set zeroVolumeCells
    Mesh non-orthogonality Max: 179.9236981551905 average: 15.42247110542158
   *Number of severely non-orthogonal (> 70 degrees) faces: 16102.
 ***Number of non-orthogonality errors: 17413.
  <<Writing 33515 non-orthogonal faces to set nonOrthoFaces
 ***Error in face pyramids: 34599 faces are incorrectly oriented.
  <<Writing 19596 faces with incorrect orientation to set wrongOrientedFaces
 ***Max skewness = 10553.61268270362, 1267 highly skew faces detected which may impair the quality of the results
  <<Writing 1267 skew faces to set skewFaces
    Coupled point location match (average 0) OK.

Failed 5 mesh checks.

/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/UnstructuredMesh.py:112: ResourceWarning: unclosed file <_io.BufferedReader name='/home/dafoamuser/dafoam/packages/miniconda3/lib/python3.7/site-packages/idwarp/idwarp.so'>
  self.warp = MExt('idwarp', [curDir], debug=debug)._module
ResourceWarning: Enable tracemalloc to get the object allocation traceback
